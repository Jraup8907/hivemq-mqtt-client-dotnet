"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[429],{8799:(e,s,i)=>{i.r(s),i.d(s,{assets:()=>h,contentTitle:()=>o,default:()=>u,frontMatter:()=>l,metadata:()=>c,toc:()=>r});var t=i(5893),n=i(1151);const l={},o="Publish",c={id:"how-to/publish",title:"Publish",description:"Simple",source:"@site/docs/how-to/publish.md",sourceDirName:"how-to",slug:"/how-to/publish",permalink:"/hivemq-mqtt-client-dotnet/docs/how-to/publish",draft:!1,unlisted:!1,editUrl:"https://github.com/hivemq/hivemq-mqtt-client-dotnet/tree/main/Documentation/docs/how-to/publish.md",tags:[],version:"current",frontMatter:{},sidebar:"docsSidebar",previous:{title:"How to Debug",permalink:"/hivemq-mqtt-client-dotnet/docs/how-to/debug"},next:{title:"How to set a Last Will & Testament",permalink:"/hivemq-mqtt-client-dotnet/docs/how-to/set-lwt"}},h={},r=[{value:"Simple",id:"simple",level:2},{value:"MQTT5PublishMessage",id:"mqtt5publishmessage",level:2},{value:"PublishMessageBuilder",id:"publishmessagebuilder",level:2},{value:"Publish Return Value: <code>PublishResult</code>",id:"publish-return-value-publishresult",level:2},{value:"See Also",id:"see-also",level:2}];function a(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,n.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.h1,{id:"publish",children:"Publish"}),"\n",(0,t.jsx)(s.h2,{id:"simple",children:"Simple"}),"\n",(0,t.jsx)(s.p,{children:"The simple way to publish a message is to use the following API:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-csharp",children:"await client.PublishAsync(\n                \"core/dynamic_graph/entity/227489\", // Topic to publish to\n                \"{'2023': '\ud83d\udc4d'}\",                   // Message to publish\n                QualityOfService.AtMostOnceDelivery\n                ).ConfigureAwait(false);\n\n"})}),"\n",(0,t.jsx)(s.p,{children:"The 3 arguments are:"}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsxs)(s.li,{children:["The topic to publish to (",(0,t.jsx)(s.code,{children:"string"}),")"]}),"\n",(0,t.jsxs)(s.li,{children:["The message to publish (",(0,t.jsx)(s.code,{children:"string"})," or ",(0,t.jsx)(s.code,{children:"byte[]"}),")"]}),"\n",(0,t.jsxs)(s.li,{children:["Quality of Service level (defaults to ",(0,t.jsx)(s.code,{children:"AtMostOnceDelivery"}),")"]}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:["For the Quality of Service, see the ",(0,t.jsx)(s.a,{href:"https://github.com/hivemq/hivemq-mqtt-client-dotnet/blob/main/Source/HiveMQtt/MQTT5/Types/QualityOfService.cs",children:"QualityOfService enum"}),"."]}),"\n",(0,t.jsx)(s.p,{children:"But if you want more control and extended options for a publish, see the next section."}),"\n",(0,t.jsx)(s.h2,{id:"mqtt5publishmessage",children:"MQTT5PublishMessage"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.a,{href:"https://github.com/hivemq/hivemq-mqtt-client-dotnet/blob/main/Source/HiveMQtt/MQTT5/Types/MQTT5PublishMessage.cs",children:"MQTT5PublishMessage"})," class represents the entirety of a publish message in MQTT.  If you construct this class directly, you can access all of the MQTT publish options such as ",(0,t.jsx)(s.code,{children:"Retain"}),", ",(0,t.jsx)(s.code,{children:"PayloadFormatIndicator"}),", ",(0,t.jsx)(s.code,{children:"UserProperties"})," and so forth."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-csharp",children:'var message = new MQTT5PublishMessage\n{\n    Topic = topic,\n    Payload = Encoding.ASCII.GetBytes(payload),\n    QoS = qos,\n};\n\nmessage.Retain = True\nmessage.UserProperties.Add("Client-Geo", "-33.8688, 151.2093");\n\nvar result = await client.PublishAsync(message);\n'})}),"\n",(0,t.jsxs)(s.p,{children:["For the full details, see the source code on ",(0,t.jsx)(s.a,{href:"https://github.com/hivemq/hivemq-mqtt-client-dotnet/blob/main/Source/HiveMQtt/MQTT5/Types/MQTT5PublishMessage.cs",children:"MQTT5PublishMessage"}),"."]}),"\n",(0,t.jsx)(s.h2,{id:"publishmessagebuilder",children:"PublishMessageBuilder"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:"PublishMessageBuilder"})," class provides a convenient way to construct MQTT publish messages with various options and properties. It allows you to customize the topic, payload, quality of service (QoS) level, retain flag, and other attributes of the message."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-csharp",children:'var publishMessage = new PublishMessageBuilder().\n                            WithTopic("topic1/example").\n                            WithPayload("{\'HiveMQ\': \'\ud83d\udc4d\'}").\n                            WithContentType("application/json")\n                            WithResponseTopic("response/topic")\n                            Build();\n\nawait client.PublishAsync(publishMessage).ConfigureAwait(false);\n'})}),"\n",(0,t.jsxs)(s.p,{children:["By using ",(0,t.jsx)(s.code,{children:"PublishMessageBuilder"}),", you can easily construct MQTT publish messages with the desired properties and options. It provides a fluent and intuitive way to customize the topic, payload, QoS level, retain flag, and other attributes of the message."]}),"\n",(0,t.jsxs)(s.h2,{id:"publish-return-value-publishresult",children:["Publish Return Value: ",(0,t.jsx)(s.code,{children:"PublishResult"})]}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:"PublishAsync"})," method returns a ",(0,t.jsx)(s.code,{children:"PublishResult"})," object."]}),"\n",(0,t.jsxs)(s.p,{children:["For ",(0,t.jsx)(s.code,{children:"QualityOfService.AtMostOnceDelivery"}),", since it's a \"fire-and-forget\" method, it doesn't contain any useful information."]}),"\n",(0,t.jsxs)(s.p,{children:["For ",(0,t.jsx)(s.code,{children:"QualityOfService.AtLeastOnceDelivery"})," (QoS level 1) and ",(0,t.jsx)(s.code,{children:"QualityOfService.ExactlyOnceDelivery"})," (QoS level 2), the ",(0,t.jsx)(s.code,{children:"PublishResult"})," contains ",(0,t.jsx)(s.code,{children:"PublishResult.QoS1ReasonCode"})," and ",(0,t.jsx)(s.code,{children:"PublishResult.QoS2ReasonCode"})," respectfully."]}),"\n",(0,t.jsxs)(s.p,{children:["For ease of use, you can call ",(0,t.jsx)(s.code,{children:"PublishResult.ReasonCode()"})," to retrieve the appropriate result code automatically."]}),"\n",(0,t.jsx)(s.h2,{id:"see-also",children:"See Also"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"https://github.com/hivemq/hivemq-mqtt-client-dotnet/blob/main/Source/HiveMQtt/Client/PublishMessageBuilder.cs",children:"PublishMessageBuilder.cs"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"https://github.com/hivemq/hivemq-mqtt-client-dotnet/blob/main/Source/HiveMQtt/MQTT5/Types/MQTT5PublishMessage.cs",children:"MQTT5PublishMessage.cs"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"https://github.com/hivemq/hivemq-mqtt-client-dotnet/blob/main/Source/HiveMQtt/MQTT5/Types/QualityOfService.cs",children:"QualityOfService.cs"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"https://github.com/hivemq/hivemq-mqtt-client-dotnet/blob/main/Source/HiveMQtt/Client/Results/PublishResult.cs",children:"PublishResult.cs"})}),"\n"]})]})}function u(e={}){const{wrapper:s}={...(0,n.a)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},1151:(e,s,i)=>{i.d(s,{Z:()=>c,a:()=>o});var t=i(7294);const n={},l=t.createContext(n);function o(e){const s=t.useContext(l);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),t.createElement(l.Provider,{value:s},e.children)}}}]);