"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[868],{9449:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>c,contentTitle:()=>a,default:()=>p,frontMatter:()=>o,metadata:()=>l,toc:()=>r});var s=n(5893),i=n(1151);const o={},a="How to set a Last Will & Testament",l={id:"how-to/set-lwt",title:"How to set a Last Will & Testament",description:"The Last Will and Testament support of MQTT can be used to notify subscribers that your client is offline.",source:"@site/docs/how-to/set-lwt.md",sourceDirName:"how-to",slug:"/how-to/set-lwt",permalink:"/hivemq-mqtt-client-dotnet/docs/how-to/set-lwt",draft:!1,unlisted:!1,editUrl:"https://github.com/hivemq/hivemq-mqtt-client-dotnet/tree/main/Documentation/docs/how-to/set-lwt.md",tags:[],version:"current",frontMatter:{},sidebar:"docsSidebar",previous:{title:"Securely Connect to a Broker with Basic Authentication Credentials",permalink:"/hivemq-mqtt-client-dotnet/docs/how-to/connect-with-auth"},next:{title:"Subscribe & Publish",permalink:"/hivemq-mqtt-client-dotnet/docs/how-to/sub-and-pub"}},c={},r=[];function d(t){const e={a:"a",code:"code",h1:"h1",p:"p",pre:"pre",...(0,i.a)(),...t.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.h1,{id:"how-to-set-a-last-will--testament",children:"How to set a Last Will & Testament"}),"\n",(0,s.jsx)(e.p,{children:"The Last Will and Testament support of MQTT can be used to notify subscribers that your client is offline."}),"\n",(0,s.jsxs)(e.p,{children:["For a more in-depth explanation, see ",(0,s.jsx)(e.a,{href:"https://www.hivemq.com/blog/mqtt-essentials-part-9-last-will-and-testament/",children:"What is MQTT Last Will and Testament (LWT)? \u2013 MQTT Essentials: Part 9"}),"."]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-csharp",children:'// Specify the Last Will and Testament specifics in HiveMQClientOptions\nvar options = new HiveMQClientOptions\n{\n    LastWillAndTestament = new LastWillAndTestament("custom/lastwill/topic", QualityOfService.AtLeastOnceDelivery, "last will message"),\n};\n\n// Optionally set extended properties on the Last Will and Testament message\noptions.LastWillAndTestament.WillDelayInterval = 1;\noptions.LastWillAndTestament.PayloadFormatIndicator = 1;\noptions.LastWillAndTestament.MessageExpiryInterval = 100;\noptions.LastWillAndTestament.ContentType = "application/text";\noptions.LastWillAndTestament.ResponseTopic = "response/topic";\noptions.LastWillAndTestament.CorrelationData = new byte[] { 1, 2, 3, 4, 5 };\noptions.LastWillAndTestament.UserProperties.Add("userPropertyKey", "userPropertyValue");\n\n// ConnectAsync will transmit the Last Will and Testament configuration.\nvar client = new HiveMQClient(options);\nconnectResult = await client.ConnectAsync().ConfigureAwait(false);\n\n// The Last Will and Testament message will be sent to the "custom/lastwill/topic" topic if your clients get\n// unexpectedly disconnected or alternatively, if your client disconnects with `DisconnectWithWillMessage`\nvar disconnectOptions = new DisconnectOptions { ReasonCode = DisconnectReasonCode.DisconnectWithWillMessage };\nvar disconnectResult = await client.DisconnectAsync(disconnectOptions).ConfigureAwait(false);\n'})}),"\n",(0,s.jsxs)(e.p,{children:["Because the client above disconnected with ",(0,s.jsx)(e.code,{children:"DisconnectReasonCode.DisconnectWithWillMessage"}),", subscribers to the ",(0,s.jsx)(e.code,{children:"last/will"})," topic will receive the Last Will and Testament message as specified above."]})]})}function p(t={}){const{wrapper:e}={...(0,i.a)(),...t.components};return e?(0,s.jsx)(e,{...t,children:(0,s.jsx)(d,{...t})}):d(t)}},1151:(t,e,n)=>{n.d(e,{Z:()=>l,a:()=>a});var s=n(7294);const i={},o=s.createContext(i);function a(t){const e=s.useContext(o);return s.useMemo((function(){return"function"==typeof t?t(e):{...e,...t}}),[e,t])}function l(t){let e;return e=t.disableParentContext?"function"==typeof t.components?t.components(i):t.components||i:a(t.components),s.createElement(o.Provider,{value:e},t.children)}}}]);